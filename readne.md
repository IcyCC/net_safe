# 安全通信套件

提供模拟阻塞套接字的安全层的行为

## GetStart

### 产生证书

```
auto ca = CA();
ca.Loads("45257_227891_31939 44085 10430 44085 21968 30565 10430 10430 21968 34470 47454 20006 ");
```

### 初始化

```youtrack
 auto ssl = SSLHandler(clnt_sock, 共钥,私钥, 可信第三方共钥, 证书);
```

### 握手

客户端
```youtrack
auto s = ssl.DoShakeHandsClient();

```
   
服务端
```youtrack
auto s = ssl.DoShakeHandsServer();

```

## 读写

```youtrack
std::string msg;
ssl.S_Read(msg);

std::cout<<msg<<std::endl;

ssl.S_Write(message);
```


## 安全算法

密钥交换和签名: rsa
对称加密: aes
哈希: sha512

## 流程
* Client Hello    客户端发送给服务器端需要的信息。 对应于上图中的步骤
* 服务器端给客户端发送证书
* 客户端认证服务端证书，并给服务端发送证书，
* 服务端认证证书, 服务器回复客户端：加密后的会话密钥和会话密钥签名
* 客户端验证会话密钥签名, 客户端给服务端发送OK ，客户端握手结束
* 服务端接受OK，服务端握手结束
* 客户端与服务器端开始加密通信    客户端与服务器端使用前面生成的会话密钥进行加密发送给对方的数据、解密接收到对方的数据，并对对方的消息进行hash校验


## 分析

1. 通过可信第三方的签名保证双方的证书是正确的
2. 通过会会话密钥签名加密可以防止会话被截取篡改
3. 区分客户端服务端的握手流程
4. 通讯时通过对称加密速度快，且用hash进行了消息的完整性的检查
